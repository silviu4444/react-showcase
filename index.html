<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover"
    />
    <style>
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
      }

      #bootstrap-loader {
        position: fixed;
        inset: 0;
        display: flex;
        z-index: 10000;
        width: 100%;
        height: 100vh;
        align-items: center;
        justify-content: center;
        background-color: hsl(var(--loader-background));
      }

      .bootstrap-loader-text {
        cursor: default;
        background: linear-gradient(to right, #3e63dd, #8e4ec6, #d6409f);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-family: sans-serif;
        font-size: 32px;
        font-weight: bold;
      }
    </style>
    <title>immobilis</title>
  </head>
  <body class="overflow-y-hidden">
    <div id="root" class="pt-safe-top pl-safe-left pr-safe-right pb-safe-bottom size-full"></div>
    <div id="bootstrap-loader">
      <div class="bootstrap-loader-text">immobilis</div>
    </div>
    <script type="module" src="/src/main.tsx"></script>

    <script>
      const loader = document.querySelector("#bootstrap-loader");
      if (loader) {
        document.body.style.setProperty("--loader-background", "0 0% 100%");
        const uiPreferencesRaw = localStorage.getItem("ui_preferences");

        if (uiPreferencesRaw) {
          try {
            const uiPreferences = JSON.parse(uiPreferencesRaw);
            const theme = uiPreferences?.state?.state?.themeMode;

            if (theme === "dark") {
              document.body.style.setProperty(
                "--loader-background",
                "224 71.4% 4.1"
              );
            }
          } catch (e) {
            console.error("Failed to parse ui_preferences:", e);
          }
        }
      }

      window.addEventListener("DOMContentLoaded", () => {
        const preloader = document.querySelector("#bootstrap-loader");
        if (preloader) {
          setTimeout(() => {
            preloader.remove();
          }, 500);
        }
      });
    </script>
  </body>
</html>
